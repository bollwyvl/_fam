#!/usr/bin/env bash
set -eux

python -m pidgy kernel install

python -m pip check

jupyter serverextension enable --py jupyter_videochat --sys-prefix

jupyter labextension install $(cat labex.txt) --no-build --debug

# this is a fork of https://github.com/QuantStack/jupyterlab-drawio
git clone https://github.com/bollwyvl/jupyterlab-drawio

pushd jupyterlab-drawio
  git checkout add-drawio-export
  python -m pip install -e .
  jlpm
  jlpm build
  npm pack
  jupyter labextension list
  jupyter labextension install \
      ./jupyterlab-drawio-*.tgz \
      --no-build \
      --debug
popd

git clone https://github.com/bollwyvl/jupyter-videochat.git

pushd jupyter-videochat
  jlpm
  jlpm build
  npm pack
  jupyter labextension install \
      ./jupyterlab-videochat-*.tgz \
      --no-build \
      --debug
popd

git clone https://github.com/bollwyvl/jupyterlab-outsource.git

pushd jupyterlab-outsource
  jlpm --ignore-optional || jlpm || echo "well, let's try anyway"
  jlpm bootstrap
  jlpm lab:link
popd

jupyter labextension list

jupyter lab build --debug

jupyter labextension list
